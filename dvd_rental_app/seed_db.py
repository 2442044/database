import sqlite3
import os

def seed_data():
    db_path = os.path.join(os.path.dirname(__file__), 'dvd_rental.db')
    print(f"Seeding data into: {db_path}")
    conn = sqlite3.connect(db_path)
    cursor = conn.cursor()

    # Reset Data for clean slate (including Genres to ensure Japanese only)
    print("Cleaning up existing data...")
    cursor.execute("DELETE FROM rentals")
    cursor.execute("DELETE FROM dvds")
    cursor.execute("DELETE FROM genres")
    # Reset sequences
    cursor.execute("DELETE FROM sqlite_sequence WHERE name='rentals'")
    cursor.execute("DELETE FROM sqlite_sequence WHERE name='dvds'")
    cursor.execute("DELETE FROM sqlite_sequence WHERE name='genres'")

    # Genres (Japanese)
    print("Inserting Japanese Genres...")
    genres = [
        ('アクション',), ('コメディ',), ('ドラマ',), ('SF',), 
        ('ホラー',), ('アニメ',), ('恋愛',), ('ミステリー',), ('ドキュメンタリー',)
    ]
    cursor.executemany("INSERT INTO genres (name) VALUES (?)", genres)
    
    # Get genre IDs for reference
    cursor.execute("SELECT genre_id, name FROM genres")
    genre_map = {name: gid for gid, name in cursor.fetchall()}

    # Users
    users = [
        ('M00002', '佐藤 花子', '神奈川県横浜市', '080-8765-4321', '1995-05-15'),
        ('M00003', '鈴木 一郎', '大阪府大阪市', '070-1111-2222', '1985-11-20'),
        ('M00004', '高橋 健太', '愛知県名古屋市', '090-9999-8888', '2000-03-10'),
        ('M00005', '田中 美咲', '福岡県福岡市', '090-1234-5678', '1998-07-22'),
        ('M00006', '伊藤 翔太', '北海道札幌市', '080-9876-5432', '1990-12-05')
    ]
    cursor.executemany("""
        INSERT OR IGNORE INTO users (member_code, name, address, phone, birth_date) 
        VALUES (?, ?, ?, ?, ?)
    """, users)

    # DVDs (Japanese titles and descriptions)
    dvds = [
        ('インターステラー', genre_map.get('SF'), 4, 4, 'B-1', '食糧難と環境変化によって人類滅亡が迫る近未来。元エンジニアの男は、居住可能な新たな惑星を探すというミッションに選ばれ、愛する家族を地球に残して宇宙の彼方へ旅立つ。父と娘の絆、そして愛の力を描いた壮大なSF叙事詩。'),
        ('トイ・ストーリー', genre_map.get('アニメ'), 5, 5, 'C-1', 'カウボーイ人形のウッディは、アンディ少年の大のお気に入り。しかし、最新式のアクション人形バズ・ライトイヤーが現れ、主役の座を奪われてしまう。反発し合う二人だったが、やがて冒険を通じて固い友情で結ばれていく。子供から大人まで楽しめる感動のファンタジー。'),
        ('ゴッドファーザー', genre_map.get('ドラマ'), 2, 2, 'A-3', 'アメリカのマフィア界に君臨するコルレオーネ一族の盛衰を描いた傑作。偉大な父ビトーから、組織のドンとしての地位を受け継ぐことになった息子マイケルの苦悩と冷徹な決断。家族の絆と裏切りが交錯する重厚なドラマ。'),
        ('千と千尋の神隠し', genre_map.get('アニメ'), 3, 3, 'C-2', 'スタジオジブリ制作、宮崎駿監督作品。10歳の少女・千尋は、引越し先へ向かう途中で不思議な世界に迷い込む。そこは八百万の神々が住む世界だった。豚に変えられてしまった両親を救うため、千尋は湯屋「油屋」で働くことになる。成長と自立を描いた日本アニメーションの金字塔。'),
        ('君の名は。', genre_map.get('恋愛'), 6, 6, 'D-1', '新海誠監督作品。東京に住む男子高校生・瀧と、飛騨の山奥に住む女子高生・三葉。出会うはずのない二人が、夢の中で入れ替わっていることに気づく。時空を超えたつながりと、忘れたくない想いを描いた青春ファンタジー。'),
        ('ショーシャンクの空に', genre_map.get('ドラマ'), 3, 3, 'A-1', 'スティーヴン・キング原作、フランク・ダラボン監督作品。妻殺しの濡れ衣を着せられ、ショーシャンク刑務所に収監された元銀行員アンディ。絶望的な状況でも希望を捨てず、誠実な人柄で周囲を変えていく。長きにわたる刑務所生活と、驚きの脱獄劇を描いた感動のヒューマンドラマ。'),
        ('バック・トゥ・ザ・フューチャー', genre_map.get('SF'), 5, 5, 'B-2', 'スティーヴン・スピルバーグ製作総指揮、ロバート・ゼメキス監督作品。高校生のマーティは、友人の科学者ドクが発明したタイムマシンで30年前にタイムスリップしてしまう。そこで若き日の両親に出会い、二人の恋を成就させなければ自分の存在が消えてしまうことに。ハラハラドキドキの冒険を描いたSFアドベンチャーの傑作。'),
        ('タイタニック', genre_map.get('恋愛'), 4, 4, 'D-2', 'ジェームズ・キャメロン監督作品。豪華客船タイタニック号で出会った、貧しい青年ジャックと上流階級の娘ローズ。身分違いの恋に落ちた二人だったが、船は氷山に衝突し、沈没の時が迫る。悲劇的な運命の中で永遠の愛を誓う、世界中が涙したラブストーリー。'),
        ('となりのトトロ', genre_map.get('アニメ'), 4, 4, 'C-3', 'スタジオジブリ制作、宮崎駿監督作品。田舎へ引っ越してきたサツキとメイの姉妹。そこで出会ったのは、森の主である不思議な生き物トトロだった。子供にしか見えないトトロとの交流を描いた、心温まるファンタジー。家族みんなで楽しめる不朽の名作。'),
        ('インセプション', genre_map.get('SF'), 3, 3, 'B-3', '他人の夢の中に潜入し、アイデアを盗み出す産業スパイのコブ。彼に舞い込んだ最後の仕事は、アイデアを盗むのではなく「植え付ける（インセプション）」ことだった。複雑に入り組んだ夢の世界で繰り広げられる、圧倒的映像美のサスペンスアクション。'),
        ('ローマの休日', genre_map.get('恋愛'), 2, 2, 'D-3', '某国の王女アンは、公務に追われる日々に疲れ、ローマの街へ一人で逃げ出す。そこで出会った新聞記者ジョーと、束の間の自由な一日を過ごす。身分を隠した王女とスクープを狙う記者の、切なくも美しいラブストーリー。'),
        ('ライフ・イズ・ビューティフル', genre_map.get('ドラマ'), 3, 3, 'A-2', '第二次世界大戦下のイタリア。ユダヤ系イタリア人のグイドは、強制収容所に送られてしまう。幼い息子を怖がらせないため、彼は収容所生活を「ゲーム」だと嘘をつき、ユーモアで家族を守り抜こうとする。父の深い愛に涙が止まらない感動作。'),
        ('アベンジャーズ', genre_map.get('アクション'), 6, 6, 'E-1', '地球侵略の危機に、アイアンマン、キャプテン・アメリカ、ソー、ハルクら最強のヒーローたちが集結する。個性豊かなヒーローたちがぶつかり合いながらも結束し、強大な敵に立ち向かう。ド派手なアクションと痛快なストーリーが楽しめるエンターテインメント大作。'),
        ('セブン', genre_map.get('ミステリー'), 3, 3, 'F-1', 'キリスト教の「七つの大罪」に見立てた連続猟奇殺人事件が発生。退職間近のベテラン刑事サマセットと、血気盛んな新人刑事ミルズが捜査に当たる。雨の降り続く陰鬱な都会を舞台に、驚愕の結末へと向かうサイコサスペンス。'),
        ('アバウト・タイム', genre_map.get('恋愛'), 4, 4, 'D-4', 'タイムトラベルの能力を持つ家系に生まれた青年ティム。彼はその能力を使って、恋人メアリーとの関係をより良くしようと奮闘する。しかし、過去を変えることには代償も伴っていた。何気ない日常の尊さを教えてくれる、温かい愛の物語。')
    ]

    print("Inserting Japanese DVD data...")
    cursor.executemany("""
        INSERT INTO dvds (title, genre_id, stock_count, total_stock, storage_location, description) 
        VALUES (?, ?, ?, ?, ?, ?)
    """, dvds)

    conn.commit()
    conn.close()
    print("Japanese sample data inserted successfully.")

if __name__ == '__main__':
    seed_data()
